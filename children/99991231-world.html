<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<div id="free-map" style="height: 400px;"></div>
<input id="point-name">
<button onclick="send();" translate="no">ğŸš€</button>




<script>
  // 3. åˆå§‹åŒ–åœ°åœ–ï¼Œè¨­å®šåº§æ¨™ [ç·¯åº¦, ç¶“åº¦] èˆ‡ ç¸®æ”¾ç­‰ç´š
  var map = L.map('free-map').setView([25.0330, 121.5654], 13);

  async function initMap(gp, name) {  
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);
  }
  
  async function useCoordsGenPoint(gps, name) {  
    const zoom = 1;  // è¶Šå°ç‰ˆåœ–è¶Šå¤§
    map.setView(gps, zoom);  // ç§»å‹•åœ°åœ–
    L.marker(gps).addTo(map)  // æ¨™è¨˜åœ°é»
      .bindPopup(name)
      .openPopup();
  }

  // 4. åŠ å…¥ OpenStreetMap åœ–å±¤ (é€™æ˜¯åœ°åœ–å½±åƒçš„ä¾†æº)
  initMap();

  // 5. åŠ å…¥ä¸€å€‹æ¨™è¨˜é» (Marker)
  ///useCoordsGenPoint([25.0330, 121.5654], 'é€™æ˜¯å°åŒ— 101 é™„è¿‘');


</script>


<script>

  async function useCoordsGenPointbyName(name) {
    const response = await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(name)}`);
    const data = await response.json();

    if (data && data.length > 0) {
      const lat = data[0].lat;
      const lon = data[0].lon;
      console.log(`æ‰¾åˆ°åº§æ¨™ï¼š${lat}, ${lon}`);
      ///return [lat, lon]
      
      // å°‡åœ°åœ–ç§»å‹•åˆ°è©²é»ä¸¦æ’æ——
      let gps = [lat, lon];
      useCoordsGenPoint(gps, name);
      ///map.setView([lat, lon], 15);
      ///L.marker([lat, lon]).addTo(map).bindPopup(name).openPopup();
    } else {
      alert("æ‰¾ä¸åˆ°é€™å€‹åœ°é»");
    }
  }  
  
  async function send() {  
    const zoom = 1;  // è¶Šå°ç‰ˆåœ–è¶Šå¤§
    const name = document.getElementById('point-name').value;
    useCoordsGenPointbyName(name);
  }

</script>



<script>
  useCoordsGenPoint([25.0330, 121.5654], 'é€™æ˜¯å°åŒ— 101 é™„è¿‘');
  useCoordsGenPointbyName('æ—¥æœ¬æ±äº¬');
</script>
