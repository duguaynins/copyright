<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>nins/generate</title>
</head>
<body style="
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    text-align: center;
    flex-direction: column;
">
  <h3>System Prompt</h3>
  <textarea id="systemText" rows="3" cols="50" placeholder="輸入 system 提示..."></textarea>

  <h3>User Text</h3>
  <textarea id="userText" rows="3" cols="50" placeholder="輸入要翻譯的文字..."></textarea>

  <br><br>
  <button id="translateBtn">generate</button>

  <!--h3>Result</h3-->
  <div id="resultText"></div>

  <script>
    const btn = document.getElementById("translateBtn");
    const systemText = document.getElementById("systemText");
    const userText = document.getElementById("userText");
    const resultText = document.getElementById("resultText");

    async function generate() {
      const systemContent = systemText.value.trim();
      const userContent = userText.value.trim();

      if (!userContent) {
        ///alert("請輸入要翻譯的文字");
        systemText.value = "You are an interesting girl";
        userText.value = "Tell me a joke";
        return;
      }

      // 組成 messages
      const messages = [];
      messages.push({ role: "system", content: systemContent });
      messages.push({ role: "user", content: userContent });

      try {
        const response = await fetch("https://duguaynins-RedirectAPI.hf.space/generate/chatgpt", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            model: "gpt-4o-mini",
            system: systemContent,
            user: userContent,
            max_tokens: 500,
            temperature: 0,
          })
        });

        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        const data = await response.json();
        console.log(data);

        resultText.textContent = data.translated_text || JSON.stringify(data);
      } catch (err) {
        console.error(err);
        resultText.textContent = "ERROR：" + err.message;
      }
    }

    btn.addEventListener("click", generate);
  </script>
</body>
</html>
