<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" sizes="48x48" href="data:image/x-icon;base64,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">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--meta name="robots" content="noindex,nofollow"-->
    <!--link rel="canonical" href="https://firefx.nins.cc/?"-->
    <link rel="canonical" href="https://copyright.nins.cc/">

    <!--<!<!tinins/fire=f(x)</title-->
    <title>nins/xmas</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f8fafc; height: 100vh; margin: 0; overflow: hidden; font-family: 'JetBrains Mono', monospace; }
        .glass-card { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(51, 65, 85, 1); z-index: 20; }
        canvas { cursor: crosshair; touch-action: none; background: #020617; width: 100%; height: 100%; }
        
        input[type=range] { height: 8px; -webkit-appearance: none; background: #334155; border-radius: 4px; flex: 1; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
        #sliderZ::-webkit-slider-thumb { background: #f59e0b; box-shadow: 0 0 10px #f59e0b; }

        @keyframes scanline { 0% { transform: translateY(-100%); } 100% { transform: translateY(100%); } }
        .scan-effect::after { content: ""; position: absolute; inset: 0; background: linear-gradient(to bottom, transparent, rgba(56, 189, 248, 0.1), transparent); animation: scanline 3s linear infinite; pointer-events: none; }

        #startOverlay { position: fixed; inset: 0; z-index: 1000; background: radial-gradient(circle at center, #1e293b 0%, #020617 100%); background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .snow { position: absolute; top: -10px; color: white; user-select: none; pointer-events: none; animation: fall linear infinite; z-index: 50; }
        @keyframes fall { to { transform: translateY(105vh) rotate(360deg); } }
        
        .mode-btn { /*@apply flex flex-col items-center justify-center p-6 rounded-3xl transition-all hover:scale-105 active:scale-95 border-2;*/ }
        .hide { display: none !important; }
        
        .mode-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            border-radius: 2rem;
            font-weight: 900;
            font-size: 1.5rem;
            cursor: pointer;
            transition: transform 0.2s ease;
            background-color: #FFFFFF;
        }

        .mode-btn:hover {
            transform: scale(1.05);
            background-color: #FFFFFF;
        }
        .mode-btn:active {
            transform: scale(1.05);
            background-color: #CDCDCD;

        }
    
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        .fadeOut {
            pointer-events: none; /* ÂãïÁï´ÊúüÈñìÁ¶ÅÊ≠¢ÈªûÊìä */
            animation: fadeOut 3s forwards;
        }
        #formulaButtons {
            display: flex;          /* ÊéíÊàê‰∏ÄÊéí */
            overflow-x: auto;       /* Ê∞¥Âπ≥ÊªæÂãï */
            gap: 8px;               /* ÊåâÈàïÈñìË∑ù */
            padding: 8px;
            -webkit-overflow-scrolling: touch; /* iOS Âπ≥ÊªëÊªæÂãï */
        }
    </style>
</head>
<body class="p-4 flex flex-col items-center">

    <button disabled="" id="disabled" style="
      position: fixed;
      bottom: 0;
      top: 0; /* Ë∑ùÈõ¢È†ÇÈÉ® 0 */
      left: 0; /* Ë∑ùÈõ¢Â∑¶ÂÅ¥ 0 */
      right: 0; /* Ë∑ùÈõ¢Âè≥ÂÅ¥ 0 */
      width: 100%;
      height: 100%;
      border: none;
      padding: 0;
      margin: 0;
      /*opacity: 0;  /*‰∏çÈÄèÊòéÂ∫¶*/
      /*background: transparent;  /*‰∏çÈÄèÊòéÂ∫¶Ôºü*/
      cursor: default;
      z-index: 99999;  /* Á¢∫‰øùÂú®ÊúÄÈ´òÂ±§ */
      /*background: linear-gradient(white, transparent);*/
      background: white;
      animation: fadeOut 3s forwards;
      pointer-events: none;  /* ÂãïÁï´ÊúüÈñì‰∏çÈòªÊìã‰∫íÂãïÔºàÂèØÈÅ∏Ôºâ*/
    "></button>

    <div id="startOverlay">
        <!--div class="mb-12 text-center">
            <h1 class="text-6xl font-black text-white mb-2 tracking-tighter italic">MATH<span class="text-cyan-400">DEFENDER</span></h1>
            <p class="text-slate-400 font-bold uppercase tracking-[0.3em]">Â∫ßÊ®ôÊîîÊà™Á≥ªÁµ± - Â∫ßÊ®ôÈ°ØÂΩ±Áâà</p>
        </div-->
        
        <div id="modeSelect" class="flex flex-col   gap-8    items-center gap-6">
            <button id="xmasBtn" class="mode-btn bg-red-900/20 border-red-500 text-red-400 w-64" style="height: 100vh; width: 100vw;">
                <span class="text-4xl mb-2">üéÑ</span>
                <span class="text-2xl font-black whitespace-nowrap">*¬© nins x XMAS 25</span>
                <span class="text-2xl font-black whitespace-nowrap" style="color: RED;">= LOCK RED (X,Y)!</span>
                <!--span class="text-xs mt-2 opacity-60">ËÅñË™ïÈü≥Ê®Ç & Êìä‰∏≠‰øùÁïô</span!-->
            </button>
            <button id="normalBtn" class="mode-btn bg-cyan-900/20 border-cyan-500 text-cyan-400 w-64" style="display: none;">
                <!--span class="text-4xl mb-2">üì°</span!-->
                <!--span class="text-2xl font-black whitespace-nowrap">NORMAL MODE</span!-->
                <!--span class="text-xs mt-2 opacity-60">Èõ∑ÈÅîÈü≥Êïà & ÊéÉÊèèÁâπÊïà</span!-->
            </button>
        </div>
    </div>

    <div class="w-full h-full flex flex-col gap-3 relative">

        <div id="" class="w-full glass-card p-3 rounded-2xl flex items-center shrink-0">
            Find the target with radar, lock it with math, then fire a cosmic pulse!
        </div>

        <!-- Ëº∏ÂÖ• Scale -->
        <div id="scaleControl" class="w-full glass-card p-4 rounded-2xl flex items-center gap-6 shrink-0 border-orange-500/20">
            <div class="flex flex-col">
                <span class="text-orange-400 font-black text-2xl font-mono leading-none">üî•Z</span>
                <span class="text-slate-500 text-[10px] font-bold uppercase mt-1">Scale</span>
            </div>
            <input type="range" id="sliderZ" min="0.1" max="5" step="0.05" value="1">
            <div class="flex flex-col items-end min-w-[80px]">
                <div id="valZ" class="text-2xl font-mono font-bold text-white leading-none">1.0x</div>
                <div class="text-[10px] text-slate-500 font-bold mt-1 uppercase">Zoom</div>
            </div>
        </div>


        <!-- Main Display -->
        <div class="w-full flex-1 glass-card p-2 rounded-3xl overflow-hidden relative scan-effect">
            <canvas id="mainCanvas" class="rounded-2xl"></canvas>
            
            <!-- Left Overlay: Score -->
            <div class="absolute top-6 left-6 pointer-events-none">
                <div class="text-xs text-slate-500 uppercase font-black">Score</div>
                <div id="scoreLabel" class="text-4xl font-black text-white">0</div>
                <div id="gameStatus" class="text-cyan-400 text-[10px] mt-1 font-bold tracking-widest uppercase italic">Radar Active</div>
            </div>

            <!-- Right Overlay: Crosshair Stats [x, y, z] -->
            <div class="absolute top-6 right-6 glass-card px-4 py-2 rounded-xl border-cyan-500/30 flex gap-4 items-center">
                <a href="https://nins.cc">üëª</a>
                <p class="sr-only">nins.cc</p>
            </div>
            <!--div class="absolute top-6 right-6 pointer-events-none glass-card px-4 py-2 rounded-xl border-cyan-500/30 flex gap-4 items-center">
                <div class="flex flex-col">
                    <span class="text-[10px] text-slate-500 font-bold uppercase">Crosshair</span>
                    <div class="text-xl font-mono font-black text-white">
                        [<span class="text-cyan-400" id="statX">0</span>, 
                        <span class="text-cyan-400" id="statY">0</span>, 
                        <span class="text-orange-400" id="statZ">1.0</span>]
                    </div>
                </div>
            </div-->
        </div>
        
        <!-- END -->
        <div class="w-full glass-card p-3 rounded-2xl flex items-center shrink-0">

            <!-- Right Overlay: Crosshair Stats [x, y, z] -->
            <div class="flex flex-col bg-cyan-900/20 px-4 py-2 rounded-xl border border-cyan-500/30">
                <span class="text-[10px] text-slate-500 font-bold uppercase">Crosshair</span>
                <div class="text-xl font-mono font-black text-white">
                    [<span class="text-cyan-400" id="statX">0</span>, 
                    <span class="text-cyan-400" id="statY">0</span>, 
                    <span class="text-orange-400" id="statZ">1.0</span>]
                </div>
            </div>
            
        </div>
        <div id="formulaButtons" class="w-full glass-card p-3 rounded-2xl flex items-center shrink-0">

        </div>

        <!-- Ëº∏ÂÖ• FUNC -->
        <div class="w-full glass-card p-3 rounded-2xl flex items-center shrink-0">
            <button id="eqLabel" onclick="document.getElementById('DialogCheck').showModal();" class="text-slate-500 font-mono text-xl mr-4 font-bold hover:text-cyan-400 transition-all">y=</button>
            <input type="text" id="eqInput" class="w-full bg-slate-900/80 border border-slate-700 rounded-xl px-4 py-2 font-mono text-cyan-400 text-lg outline-none focus:ring-2 focus:ring-cyan-500" value="Math.sin(x/40) * 120">
            <button id="launchBtn" style="display: none;" class="ml-4 bg-rose-600 hover:bg-rose-500 text-white px-6 py-2 rounded-xl font-black shadow-lg shadow-rose-900/20 active:scale-95 transition-all">FIRE</button>
        </div>
        
        <!-- Âè≥ÂÅ¥ FIRE ÊåâÈàï -->
        <button id="launchBtn" onclick="launch();" class="bg-rose-600 hover:bg-rose-500 text-white px-6 py-2 rounded-xl font-black shadow-lg shadow-rose-900/20 active:scale-95 transition-all">
            FIRE
        </button>
        <!--div class="w-full glass-card p-3 rounded-2xl flex items-center shrink-0"></div-->
    </div>

    
    <dialog id="DialogCheck" translate="no">
        <pre id="logOutput" style="max-height:200px; overflow:auto; margin:0;"></pre>
        <br><button id="openLog" style="width: 100%;" onclick="document.getElementById('DialogCheck').close();console.log(new Date().toLocaleString(), 'üôà');">‚Ü©Ô∏è</button>
    </dialog>


<!-- LOG ================================================== -->
<script>
const dialog = document.getElementById('DialogCheck');
const logOutput = document.getElementById('logOutput');

// ÊîîÊà™ console.log Ëàá console.error
['log', 'error'].forEach(level => {
  const original = console[level];
  console[level] = function(...args) {
    original.apply(console, args);
    const message = args.map(a => (typeof a === 'object' ? JSON.stringify(a) : a)).join(' ');
    logOutput.insertAdjacentHTML('beforeend', `<div class="${level}">${message}</div>`);
    // ÊªæÂãïÂà∞Â∫ïÈÉ®
    logOutput.scrollTop = logOutput.scrollHeight;
  };
});

// Ê∏¨Ë©¶
const version = (new Date().toLocaleString(), 'v1.20240925.1314 (This is an error test.)');
console.error(version);
console.warn(version);
console.info(version);
console.log(version);
</script>
<!-- LOG ================================================== -->

    <script>
    // ÊåâÈàïË≥áÊñô
    const formulas = [
        { name: "ÁµïÂ∞çÂÄº", value: "Math.abs(x)" },
        { name: "ÊñπÊ≥¢", value: "Math.sign(Math.sin(x/20))*20" },
        { name: "ÁµÑÂêàÊ≥¢", value: "Math.sin(x/30)*80 + Math.sin(x/5)*10" },
        { name: "Ê≠£Âº¶", value: "Math.sin(x/58)*58" },
        { name: "È§òÂº¶", value: "Math.cos(x/58)*58" },
        { name: "Ê≠£Âàá", value: "Math.tan(x/58)*58" },
        ///{ name: "ÂÖ®ÂúìÂΩ¢", value: "¬±Math.sqrt(100*100 - x*x)" },
        { name: "ÂçäÂúìÂΩ¢", value: "Math.sqrt(100*100 - x*x)" },
        { name: "‰∏ÄÊ¨°ÂáΩÊï∏", value: "2*x + 50" },
        { name: "‰∫åÊ¨°ÂáΩÊï∏", value: "-0.01*x*x + 100" },
        { name: "‰∏âÊ¨°ÂáΩÊï∏", value: "x*x*x  / 5800" },
        { name: "ÊåáÊï∏ÂáΩÊï∏", value: "Math.pow(1.05, x)" },
        ///{ name: "ÊåáÊï∏Ë°∞Ê∏õ", value: "Math.exp(-x)" },
        { name: "Â∞çÊï∏ÂáΩÊï∏", value: "Math.log(x)*20" },
        { name: "ÈòªÂ∞ºÈúáÁõ™", value: "Math.sin(x/10)*Math.exp(-x/200)*20" },
        { name: "Èã∏ÈΩíÊ≥¢", value: "x % 50" },
        { name: "Èö®Ê©üÊ≥¢Âãï", value: "Math.random()*100" },
        
        // ÈúÄÂèÉÊï∏ t Ë°®Á§∫ÁöÑÊõ≤Á∑ö
        /*
        { name: "ÈòøÂü∫Á±≥Âæ∑Ëû∫Êóã", value: "x = t*Math.cos(t); y = t*Math.sin(t)" },
        { name: "Â∞çÊï∏Ëû∫Êóã", value: "r = Math.exp(0.1*t); x = r*Math.cos(t); y = r*Math.sin(t)" },
        { name: "Áé´Áë∞Êõ≤Á∑ö", value: "r = Math.cos(k*t); x = r*Math.cos(t); y = r*Math.sin(t)" },
        { name: "ÂøÉÂΩ¢Êõ≤Á∑ö", value: "x = 16*Math.pow(Math.sin(t),3); y = 13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t)" },
        { name: "Ë°åÊòüÁπûË°å", value: "x = cx + r*Math.cos(speed*t); y = cy + r*Math.sin(speed*t)" },
        { name: "Êì∫Á∑ö", value: "x = r*(t - Math.sin(t)); y = r*(1 - Math.cos(t))" },
        { name: "Â§ñÊì∫Á∑ö", value: "x = (R-r)*Math.cos(t)+d*Math.cos((R-r)/r*t); y = (R-r)*Math.sin(t)-d*Math.sin((R-r)/r*t)" },
        { name: "ÊùéËñ©Â¶ÇÂúñÂΩ¢", value: "x = Math.sin(t); y = Math.sin(2*t)" }
        */
    ];

    // Áî¢ÁîüÊåâÈàï
    const container = document.getElementById('formulaButtons');
    formulas.forEach(f => {
        const btn = document.createElement('button');
        btn.textContent = f.name;
        btn.style.padding = "5px 10px";
        btn.style.fontSize = "14px";
        btn.addEventListener('click', () => {
            document.getElementById('eqInput').value = f.value;
            updateEquation();
        });
        container.appendChild(btn);
    });
    </script>

    <script>
        const canvas = document.getElementById('mainCanvas'), ctx = canvas.getContext('2d');
        const eqInput = document.getElementById('eqInput'), launchBtn = document.getElementById('launchBtn');
        const sliderZ = document.getElementById('sliderZ'), valZDisplay = document.getElementById('valZ');
        const scoreLabel = document.getElementById('scoreLabel'), startOverlay = document.getElementById('startOverlay');
        const xmasBtn = document.getElementById('xmasBtn'), normalBtn = document.getElementById('normalBtn');

        let width, height, centerX, centerY;
        let curX = 0, curY = 0, scaleZ = 1;
        let score = 0, gameActive = false, isLaunching = false, gameMode = 'none';
        let currentFunc = (x) => Math.sin(x/40)*120;
        let enemies = []; 
        

        // --- Èü≥ÊïàÁ≥ªÁµ± ---
        let audioCtx = null;
        let bgmTimeout = null;
        let lastPingTime = 0;
        let pingAnim = 0;
        const PING_INTERVAL = 1500;

        document.getElementById('xmasBtn').addEventListener('click', () => {
            startOverlay.classList.add('fadeOut');  ///test***
            ///document.getElementById('modeSelect').classList.add('fadeOut');
        }, { once: true });

        document.getElementById('normalBtn').addEventListener('click', () => {
            startOverlay.classList.add('fadeOut');  ///test***
            ///document.getElementById('modeSelect').classList.add('fadeOut');
        }, { once: true });

        eqInput.addEventListener('input', (e) => {
            console.log(`y= ${eqInput.value}`);
        });

        eqInput.addEventListener('change', (e) => {
            if (true) {
                ///console.log(`y= ${eqInput.value}`);
                launch();
            }
        });

        eqInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                ///updateEquation();          // ÂÖàÊõ¥Êñ∞ÂáΩÊï∏
                ///console.log("y=", eqInput.value); // ÊØèÊ¨° Enter Âç∞Âá∫ÁõÆÂâç FX
                ///console.log(`y= ${eqInput.value}>>>`);
                launch();
            }
        });

        function initAudio() {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            if (audioCtx.state === 'suspended') audioCtx.resume();
        }

        const jingleBells = [
            {f: 659.25, d: 250}, {f: 659.25, d: 250}, {f: 659.25, d: 500},
            {f: 659.25, d: 250}, {f: 659.25, d: 250}, {f: 659.25, d: 500},
            {f: 659.25, d: 250}, {f: 783.99, d: 250}, {f: 523.25, d: 375}, {f: 587.33, d: 125}, {f: 659.25, d: 1000},
            {f: 698.46, d: 250}, {f: 698.46, d: 250}, {f: 698.46, d: 375}, {f: 698.46, d: 125},
            {f: 698.46, d: 250}, {f: 659.25, d: 250}, {f: 659.25, d: 250}, {f: 659.25, d: 125}, {f: 659.25, d: 125},
            {f: 783.99, d: 250}, {f: 783.99, d: 250}, {f: 698.46, d: 250}, {f: 587.33, d: 250}, {f: 523.25, d: 1000},
            {f: 392.00, d: 250}, {f: 523.25, d: 250}, {f: 493.88, d: 250}, {f: 440.00, d: 250}, {f: 392.00, d: 750},
            {f: 392.00, d: 125}, {f: 392.00, d: 125}, {f: 392.00, d: 250}, {f: 523.25, d: 250}, {f: 493.88, d: 250}, {f: 440.00, d: 250}, {f: 587.33, d: 750},
            {f: 587.33, d: 250}, {f: 587.33, d: 250}, {f: 659.25, d: 250}, {f: 587.33, d: 250}, {f: 523.25, d: 250}, {f: 392.00, d: 750},
            {f: 392.00, d: 250}, {f: 783.99, d: 250}, {f: 783.99, d: 250}, {f: 698.46, d: 250}, {f: 587.33, d: 250}, {f: 659.25, d: 1000}
        ];
        let noteIdx = 0;

        function playXmasBGM() {
            if (!audioCtx) return;
            const note = jingleBells[noteIdx];
            if (note.f > 0) {
                const osc = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                osc.connect(g); g.connect(audioCtx.destination);
                osc.type = 'square';
                osc.frequency.setValueAtTime(note.f, audioCtx.currentTime);
                g.gain.setValueAtTime(0.04, audioCtx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + note.d/1000);
                osc.start(); osc.stop(audioCtx.currentTime + note.d/1000);
            }
            noteIdx = (noteIdx + 1) % jingleBells.length;
            bgmTimeout = setTimeout(playXmasBGM, note.d);
        }

        function playPing() {
            if (!audioCtx || !gameActive) return;
            pingAnim = 1.0; 
            const osc = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            osc.connect(g); g.connect(audioCtx.destination);
            osc.type = 'sine';
            osc.frequency.setValueAtTime(gameMode === 'xmas' ? 400 : 300, audioCtx.currentTime);  ///Êïµ‰∫∫ÊèêÁ§∫Èü≥
            g.gain.setValueAtTime(0.03, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.4);
            osc.start(); osc.stop(audioCtx.currentTime + 0.4);
        }

        function playLaunchSound() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const g = audioCtx.createGain();
            osc.connect(g); g.connect(audioCtx.destination);
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(120, audioCtx.currentTime);
            osc.frequency.exponentialRampToValueAtTime(1200, audioCtx.currentTime + 0.25);
            g.gain.setValueAtTime(0.1, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.25);
            osc.start(); osc.stop(audioCtx.currentTime + 0.25);
        }

        function playHitSound() {
            if (!audioCtx) return;
            const buffer = audioCtx.createBuffer(1, audioCtx.sampleRate * 0.3, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < data.length; i++) data[i] = Math.random() * 2 - 1;
            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer;
            const g = audioCtx.createGain();
            g.gain.setValueAtTime(0.3, audioCtx.currentTime);
            g.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.3);
            noise.connect(g); g.connect(audioCtx.destination);
            noise.start();
        }

        function createSnow() {
            if (!gameActive || gameMode !== 'xmas') return;
            const snow = document.createElement('div');
            snow.className = 'snow';
            snow.innerHTML = '‚ùÑ';
            snow.style.left = Math.random() * 100 + 'vw';
            snow.style.fontSize = (Math.random() * 10 + 10) + 'px';
            snow.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.body.appendChild(snow);
            setTimeout(() => snow.remove(), 5000);
        }
        setInterval(createSnow, 300);

        function init() {
            const dpr = window.devicePixelRatio || 1;
            width = canvas.clientWidth; height = canvas.clientHeight;
            canvas.width = width * dpr; canvas.height = height * dpr;
            ctx.scale(dpr, dpr);
            centerX = width / 2; centerY = height / 2;
            updateEquation();
        }

        function updateEquation() {
            try { currentFunc = new Function('x', `return ${eqInput.value};`); } catch (e) {}
        }

        function spawnEnemy() {
            enemies.push({
                x: Math.round((Math.random() - 0.5) * (width / scaleZ * 0.7)),
                y: Math.round((Math.random() - 0.5) * (height / scaleZ * 0.7)),
                destroyed: false,
                hitFlash: 0
            });
        }

        function drawGrid() {
            const gridSize = 50 * scaleZ;
            ctx.strokeStyle = gameMode === 'xmas' ? '#2d1a1a' : '#1e293b'; 
            ctx.lineWidth = 1; ctx.beginPath();
            for(let x = centerX % gridSize; x < width; x += gridSize) { ctx.moveTo(x, 0); ctx.lineTo(x, height); }
            for(let y = centerY % gridSize; y < height; y += gridSize) { ctx.moveTo(0, y); ctx.lineTo(width, y); }
            ctx.stroke();
            ctx.strokeStyle = '#334155'; ctx.lineWidth = 2; ctx.beginPath();
            ctx.moveTo(0, centerY); ctx.lineTo(width, centerY); ctx.moveTo(centerX, 0); ctx.lineTo(centerX, height); ctx.stroke();
        }

        function render(time) {
            // Update UI Stats
            statX.innerText = curX.toFixed(1);
            statY.innerText = curY.toFixed(1);
            statZ.innerText = scaleZ.toFixed(1);

            ctx.clearRect(0, 0, width, height);
            drawGrid();

            if (gameActive && time - lastPingTime > PING_INTERVAL) { playPing(); lastPingTime = time; }
            if (pingAnim > 0) pingAnim -= 0.015;

            // 1. ÂáΩÊï∏ÂúñÂΩ¢
            try {
                ctx.beginPath();
                ctx.strokeStyle = isLaunching ? '#fb7185' : (gameMode === 'xmas' ? '#f87171' : '#38bdf8');
                ctx.lineWidth = isLaunching ? 6 : 3;
                let first = true;
                for (let px = 0; px <= width; px += 1) {
                    const x = (px - centerX) / scaleZ;
                    const y = currentFunc(x);
                    const py = centerY - (y * scaleZ);
                    if (Number.isFinite(py)) {
                        if (first) { ctx.moveTo(px, py); first = false; }
                        else { ctx.lineTo(px, py); }
                    }
                }
                ctx.stroke();
            } catch(e) {}

            // 2. Ê∫ñÊòü
            try { const y = currentFunc(curX); curY = Number.isFinite(y) ? y : 0; } catch(e) { curY = 0; }
            const cx = centerX + (curX * scaleZ);
            const cy = centerY - (curY * scaleZ);
            ctx.setLineDash([5, 5]); ctx.strokeStyle = 'rgba(255, 255, 255, 0.1)'; ctx.beginPath();
            ctx.moveTo(cx, 0); ctx.lineTo(cx, height); ctx.moveTo(0, cy); ctx.lineTo(width, cy); ctx.stroke();
            ctx.setLineDash([]);
            ctx.fillStyle = '#fff'; ctx.beginPath(); ctx.arc(cx, cy, 5, 0, Math.PI * 2); ctx.fill();

            // 3. Êïµ‰∫∫Ê∏≤ÊüìÈÇèËºØ
            enemies.forEach(en => {
                const ex = centerX + (en.x * scaleZ), ey = centerY - (en.y * scaleZ);
                
                ctx.save();
                
                // --- Áπ™Ë£ΩÂ∫ßÊ®ôÊï∏ÂÄº (ÂßãÁµÇÈ°ØÁ§∫) ---
                ctx.font = "bold 13px 'JetBrains Mono'";
                ctx.textAlign = "center";
                if (!en.destroyed) {
                    // Êú™Êìä‰∏≠ÔºöÊ∑°Ê∑°ÁöÑÈùíËâ≤ÔºåÂ∏∂ÊúâÂëºÂê∏ÊÑü
                    const pulse = 0.3 + Math.sin(time / 200) * 0.2;
                    ///ctx.fillStyle = `rgba(56, 189, 248, ${pulse})`;
                    ///ctx.fillStyle = `rgba(255, 255, 255, ${pulse})`;
                    ctx.fillStyle = '#ff0000';
                } else {
                    // Â∑≤Êìä‰∏≠ÔºöÁ©©ÂÆöÁöÑÁÅ∞Ëâ≤
                    ctx.fillStyle = "rgba(255, 255, 255, 0.5)";
                }
                ctx.fillText(`(${en.x}, ${en.y})`, ex, ey - 22);

                // --- Áπ™Ë£ΩÊïµ‰∫∫Êú¨È´î ---
                if (!en.destroyed) {
                    // ‰∏ÄÈñãÂßãÊú¨È´îÂÆåÂÖ®ÈÄèÊòé (Alpha = 0)
                    ctx.globalAlpha = 0; 
                    
                    // Èõ∑ÈÅîÊ≥¢Á¥ã
                    if (pingAnim > 0) {
                        ctx.save();
                        ctx.globalAlpha = pingAnim;
                        ctx.beginPath(); ctx.arc(ex, ey, (1 - pingAnim) * 120, 0, Math.PI * 2);
                        ctx.strokeStyle = gameMode === 'xmas' ? '#ef4444' : '#f43f5e'; 
                        ctx.lineWidth = 2; ctx.stroke();
                        ctx.restore();
                    }
                } else {
                    // Êìä‰∏≠Âæå 50% ÈÄèÊòéÂ∫¶È°ØÂΩ±
                    ctx.globalAlpha = 0.5;
                }

                // Êìä‰∏≠Áû¨ÈñìÈñÉÂÖâÊàñÂ∏∏Ë¶èÈ°èËâ≤
                if (en.hitFlash > 0) { 
                    ctx.globalAlpha = en.hitFlash; 
                    ctx.fillStyle = '#fff'; 
                    en.hitFlash -= 0.05; 
                } else { 
                    ctx.fillStyle = gameMode === 'xmas' ? '#fbbf24' : '#f43f5e'; 
                }

                ctx.beginPath(); ctx.arc(ex, ey, 10, 0, Math.PI * 2); ctx.fill();
                ctx.strokeStyle = '#fff'; ctx.lineWidth = 2; ctx.stroke();
                
                ctx.restore();
            });

            requestAnimationFrame(render);
        }

        function launch() {
            console.log(`y= ${eqInput.value}>>>`);

            if (isLaunching || !gameActive) return;
            isLaunching = true;
            playLaunchSound();

            enemies.forEach(en => {
                if (en.destroyed) return;

                let hit = false;
                try {
                    const funcValAtX = currentFunc(en.x);
                    
                    // Âà§ÂÆöÔºöÁ≤æÁ¢∫Êìä‰∏≠ y Â∫ßÊ®ô
                    if (Number.isFinite(funcValAtX) && Math.round(funcValAtX) === en.y) {
                        hit = true;
                    }

                    if (!hit) {
                        // Ê™¢Êü•Áï∂ÂâçÊâãÂãïÊ∫ñÊòü‰ΩçÁΩÆÊòØÂê¶ÈáçÂêà
                        if (Math.round(curX) === en.x && Math.round(curY) === en.y) {
                            hit = true;
                        }
                    }
                } catch(e) {}

                if (hit) {
                    en.destroyed = true;
                    en.hitFlash = 1.0;
                    score += 100;
                    scoreLabel.innerText = score;
                    playHitSound();
                    setTimeout(spawnEnemy, 800);
                }
            });

            setTimeout(() => isLaunching = false, 400);
        }

        canvas.onpointermove = (e) => {
            const rect = canvas.getBoundingClientRect();
            curX = Math.round(((e.clientX - rect.left) - centerX) / scaleZ);
        };
        canvas.onpointerdown = launch;
        ///canvas.onpointerdown = 
        launchBtn.onclick = launch;
        eqInput.oninput = updateEquation;
        sliderZ.oninput = (e) => {
            scaleZ = parseFloat(e.target.value);
            valZDisplay.innerText = scaleZ.toFixed(1) + 'x';
        };
        ///document.getElementById('eqLabel').onclick = () => document.getElementById('scaleControl').classList.toggle('hide');

        const start = (mode) => {
            initAudio();
            gameMode = mode;
            gameActive = true;

            // Âü∑Ë°åÊ∑°Âá∫ÂãïÁï´
            ///startOverlay.style.display = 'none';
            startOverlay.classList.add('fadeOut');  ///test***
            setTimeout(() => { startOverlay.disabled = true; }, 1);
            setTimeout(() => { startOverlay.style.display = "none"; }, 3000);
            ///document.getElementById('modeSelect').classList.add('fadeOut');

            // ÂÖ®Ëû¢Âπï & Âõ∫ÂÆöÁõ¥Âêë
            const elem = document.documentElement; // ÂÖ®È†ÅÈù¢
            if (elem.requestFullscreen) {
                elem.requestFullscreen().then(() => {
                    // ÂòóË©¶ÈéñÂÆöÁõ¥Âêë
                    if (screen.orientation && screen.orientation.lock) {
                        screen.orientation.lock('portrait').catch(err => {
                            console.warn('ÁÑ°Ê≥ïÈéñÂÆöÁõ¥Âêë:', err);
                        });
                    }
                }).catch(err => {
                    console.warn('ÁÑ°Ê≥ïÈÄ≤ÂÖ•ÂÖ®Ëû¢Âπï:', err);
                });
            }

            // Êí≠ÊîæÂ∞çÊáâÈü≥Ê®Ç
            if(mode === 'xmas') playXmasBGM();
            init(); spawnEnemy(); requestAnimationFrame(render);
        };

        xmasBtn.onclick = () => start('xmas');
        normalBtn.onclick = () => start('normal');
        window.onresize = init;
    </script>
</body>
</html>
